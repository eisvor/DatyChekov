#Если Сервер Или ТолстыйКлиентОбычноеПриложение Или ВнешнееСоединение Тогда

#Область ПрограммныйИнтерфейс

// Процедура записывает таблицу значений в РС "Настройки пользователей", 
// 
// Параметры:
//  ТаблицаНастроек - ТаблицаЗначений - таблица настроек пользователей для записи.
//
Процедура ЗаписатьНастройкиПользователя(ТаблицаНастроек) Экспорт
	
	НачатьТранзакцию();
	
	Попытка
		
		Если ТаблицаНастроек.Количество() > 0 Тогда
			
			НаборЗаписей = РегистрыСведений.НастройкиПользователей.СоздатьНаборЗаписей();
			НаборЗаписей.Отбор.Пользователь.Установить(ТаблицаНастроек[0].Пользователь);
			НаборЗаписей.Отбор.Магазин.Установить(ТаблицаНастроек[0].Магазин);
			НаборЗаписей.Прочитать();
			НаборЗаписей.Очистить();
			
			Для каждого СтрокаТаблицыНастроек Из ТаблицаНастроек Цикл
				
				Если ЗначениеЗаполнено(СтрокаТаблицыНастроек.Значение) Тогда
					Запись = НаборЗаписей.Добавить();
					ЗаполнитьЗначенияСвойств(Запись, СтрокаТаблицыНастроек);
				КонецЕсли;
				
			КонецЦикла;
			
			НаборЗаписей.Записать();
			
		КонецЕсли;
		ЗафиксироватьТранзакцию();
		
	Исключение
		
		ОтменитьТранзакцию();
		
	КонецПопытки;
	
КонецПроцедуры

// СтандартныеПодсистемы.УправлениеДоступом

// См. УправлениеДоступомПереопределяемый.ПриЗаполненииСписковСОграничениемДоступа.
Процедура ПриЗаполненииОграниченияДоступа(Ограничение) Экспорт

	Ограничение.Текст =
	"РазрешитьЧтениеИзменение
	|ГДЕ
	|	ЗначениеРазрешено(Магазин)";

КонецПроцедуры

// Конец СтандартныеПодсистемы.УправлениеДоступом

#КонецОбласти

#КонецЕсли