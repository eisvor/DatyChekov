
#Область ОбработчикиСобытийФормы
&НаСервере
Процедура ПриСозданииНаСервере(Отказ, СтандартнаяОбработка)
	
	ТорговыйОбъект = Параметры.ТорговыйОбъект;
	АдресХранилищаТаблицы = "";
	АдресХранилищаТаблицы = ПоместитьВоВременноеХранилище(ТаблицаСотрудников.Выгрузить());

	
	ОбщегоНазначенияРМКПереопределяемый.ЗаполнитьТаблицуСотрудников(АдресХранилищаТаблицы, ТорговыйОбъект);
	
	ТаблицаСотрудников.Загрузить(ПолучитьИзВременногоХранилища(АдресХранилищаТаблицы));
	
КонецПроцедуры

&НаКлиенте
Процедура ОтметитьВсех(Команда)
	Для Каждого СтрокаТаблицы Из ТаблицаСотрудников Цикл
		СтрокаТаблицы.Отметка = Истина;
	КонецЦикла;
КонецПроцедуры

&НаКлиенте
Процедура СнятьОтметкуВсех(Команда)
	Для Каждого СтрокаТаблицы Из ТаблицаСотрудников Цикл
		СтрокаТаблицы.Отметка = Ложь;
	КонецЦикла;
КонецПроцедуры

&НаСервере
Процедура СоздатьПользователейПоОтмеченнымНаСервере()
	МассивВыбранныхФизическихЛиц = Новый Массив;
	
	Для Каждого СтрокаТаблицы Из ТаблицаСотрудников Цикл
		Если СтрокаТаблицы.Отметка Тогда
			МассивВыбранныхФизическихЛиц.Добавить(СтрокаТаблицы.ФизическоеЛицо);
		КонецЕсли;
	КонецЦикла;
	
	ОбщегоНазначенияРМКПереопределяемый.СоздатьПользователейПоМассивуФизЛиц(МассивВыбранныхФизическихЛиц, ТорговыйОбъект);
	
КонецПроцедуры

&НаКлиенте
Процедура СоздатьПользователейПоОтмеченным(Команда)
	СоздатьПользователейПоОтмеченнымНаСервере();
	Закрыть();
КонецПроцедуры

&НаКлиенте
Процедура ПередЗакрытием(Отказ, ЗавершениеРаботы, ТекстПредупреждения, СтандартнаяОбработка)
	Оповестить("СозданиеПользователейПоСотрудникам");
КонецПроцедуры


#КонецОбласти